<div id="top-menu"></div>

<script>
  fetch("top-menu.html")
    .then(res => res.text())
    .then(data => {
      document.getElementById("top-menu").innerHTML = data;
    });
</script>

<!-- ✅ Correct BibTeX parser -->
<script src="js/25/bibtexParse.js"></script>

<script>
  async function renderBibtexList(bibPath, containerId) {
    try {
      const res = await fetch(bibPath);
      const bibText = await res.text();

      // ✅ Now bibtexParse is defined
      const entries = bibtexParse.toJSON(bibText);
      const container = document.getElementById(containerId);
      container.innerHTML = "";

      entries.forEach(entry => {
        const tags = entry.entryTags || {};

        const title    = tags.title    || "Untitled";
        const authors  = tags.author   || "";
        const year     = tags.year     || "";
        const journal  = tags.journal  || tags.booktitle || "";
        const url      = tags.url      || "";
        const doi      = tags.doi      || "";

        const card = document.createElement("div");
        card.className = "card mb-3 shadow-sm";

        card.innerHTML = `
          <div class="card-body">
            <h5 class="card-title mb-1">${title}</h5>
            <p class="card-subtitle text-muted mb-1">${authors}</p>
            <p class="mb-2">
              ${journal ? `<em>${journal}</em>` : ""}${year ? (journal ? ", " : "") + year : ""}
            </p>
            <div class="d-flex flex-wrap gap-2">
              ${url ? `<a href="${url}" target="_blank" rel="noopener" class="btn btn-outline-dark btn-sm">Link</a>` : ""}
              ${doi ? `<a href="https://doi.org/${doi}" target="_blank" rel="noopener" class="btn btn-outline-dark btn-sm">DOI</a>` : ""}
            </div>
          </div>
        `;

        container.appendChild(card);
      });
    } catch (e) {
      console.error("Error loading bib file:", bibPath, e);
      const container = document.getElementById(containerId);
      container.innerHTML = `<p class="text-danger">Failed to load publications from <code>${bibPath}</code>.</p>`;
    }
  }

  // One call per section (paths assume publications.html is in the root)
  renderBibtexList("publications/journals.bib",    "journal-list");
  renderBibtexList("publications/conferences.bib", "conference-list");
  renderBibtexList("publications/conferences-no-proceeding.bib", "conference-no-proceeding-list");
</script>

<main class="flex-grow-1">
  <div class="container py-5">
    <h1>AAAA</h1>
    <div class="d-flex justify-content-center flex-wrap gap-2 mb-4">
      <a href="#journal-articles" class="btn btn-outline-dark btn-sm">Journal Articles</a>
      <a href="#conference-papers" class="btn btn-outline-dark btn-sm">Conference Papers</a>
    </div>

    <!-- Journals -->
    <section id="journal-articles" class="mb-5">
      <h2 class="mb-3">Journal Articles</h2>
      <div id="journal-list"></div>
    </section>

    <!-- Conferences -->
    <section id="conference-papers" class="mb-5">
      <h2 class="mb-3">Peer-Reviewed Conference Papers/h2>
      <div id="conference-list"></div>
    </section>

    <!-- Conferences -->
    <section id="conference-papers" class="mb-5">
      <h2 class="mb-3">Conference Posters &amp; Presentations</h2>
      <div id="conference-no-proceeding-list"></div>
    </section>

  </div>
</main>

<style>
  html { scroll-behavior: smooth; }
</style>

<div id="footer"></div>
<script>
  fetch("footer.html")
    .then(res => res.text())
    .then(data => {
      document.getElementById("footer").innerHTML = data;
    });
</script>
<script src="./js/bootstrap.bundle.min.js"></script>
